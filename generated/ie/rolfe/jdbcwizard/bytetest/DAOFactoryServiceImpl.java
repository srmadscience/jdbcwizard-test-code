package ie.rolfe.jdbcwizard.bytetest;


import com.orindasoft.pub.CSException; 
import com.orindasoft.pub.CSDBException; 
import com.orindasoft.pub.SqlUtils; 
import com.orindasoft.pub.OracleResourceUser; 
import com.orindasoft.pub.LogInterface; 
import ie.rolfe.jdbcwizard.bytetest.plsql.*; 
import com.orindasoft.pub.StatsInterface; 
// JSR-181 Support is enabled if your target JVM is 1.6 or higher...
import javax.jws.*; 
@WebService(endpointInterface = "ie.rolfe.jdbcwizard.bytetest.DAOFactoryServiceInterface")
/** 
* WSDL Compatible Web Services class used by classes generated by JDBCWizard
* Generated by JDBCWizard 6.0.3145 build 3145 at 2025/11/14 10:21:21.529 EST
*/ 
public class DAOFactoryServiceImpl extends DAOFactory implements OracleResourceUser, StatsInterface, DAOFactoryServiceInterface
{ 
 
protected boolean alwaysReleaseResources = false; 

protected boolean minValueIsNULL = false; 

protected boolean castNullToNewObject = false; 

public String oracleDirectoryDbName = "";
 
public String oracleDirectoryOsName = null;
 
public static final int BFILE_ORACLE_DIRECTORY_NAME = 0;
 
public static final int BFILE_OS_FILE_DIRECTORY = 1;
 
public static final int BFILE_OS_FILENAME = 2;
 
protected java.sql.PreparedStatement bfileSequenceStatement = null; 

public String bfileSequenceName = null; 

protected String bfileFilePrefix = "BFILE"; 

protected String bfileFileExtension = ".dat"; 

public DAOFactoryServiceImpl() 
  {                                                 
  super();
  }                                                 
                                                 
public DAOFactoryServiceImpl(java.sql.Connection theConnection, LogInterface theLog) 
  { 
  super(theConnection,theLog); 
  } 
 
public DAOFactoryServiceImpl(LogInterface theLog)      
  {                                                 
  super(theLog);
  }                                                  
   
protected void doPreServiceEvent(Object aServiceClass)
  {
  }
protected void doPostServiceEvent(Object aServiceClass)
  {
  }
 
public void setAlwaysReleaseResourcesFlag(boolean alwaysReleaseResources)
  {
  this.alwaysReleaseResources = alwaysReleaseResources;
  }
 
 
public void setMinValueIsNull(boolean minValueIsNULL)
  {
  this.minValueIsNULL = minValueIsNULL;
  }
 
 
public void setCastNullToNewObject(boolean castNullToNewObject)
  {
  this.castNullToNewObject = castNullToNewObject;
  }
 
 
protected void setOracleDirectoryDbName(String oracleDirectoryDbName)
  {
  this.oracleDirectoryDbName = oracleDirectoryDbName;
  }
 
protected void setOracleDirectoryOsName(String oracleDirectoryOsName)
  {
  this.oracleDirectoryOsName = oracleDirectoryOsName;
  }
 
 
protected void setBfileSequenceName(String bfileSequenceName)
  {
  this.bfileSequenceName = bfileSequenceName;
  }
 
protected oracle.sql.BFILE createNewBfilePointer(String methodName, String ParamName, byte[] fileData) throws CSException
  {
  
  oracle.sql.BFILE newBfile = null;
  
  try
    {
    theLog.debug("createNewBfilePointer: Calling 'createNewBfileName'");
    String[] bfileNameParts = createNewBfileName(methodName,ParamName,fileData);
      
    theLog.debug("createNewBfilePointer: Creating Java File " + bfileNameParts[BFILE_OS_FILENAME]);
    java.io.File bfileFile = new java.io.File(bfileNameParts[BFILE_OS_FILE_DIRECTORY] 
                                           + java.io.File.separator
                                           + bfileNameParts[BFILE_OS_FILENAME]);
         
    com.orindasoft.pub.IOUtils.loadByteArrayIntoFile(fileData, bfileFile, theLog);
         
    theLog.debug("createNewBfilePointer: Creating Bfile " + bfileNameParts[BFILE_ORACLE_DIRECTORY_NAME] + "/" + bfileNameParts[BFILE_OS_FILENAME]);
    newBfile = com.orindasoft.pub.SqlUtils.createBfileLocator(bfileNameParts[BFILE_ORACLE_DIRECTORY_NAME]
                                                          , bfileNameParts[BFILE_OS_FILENAME]
                                                          , theConnection
                                                          , theLog
                                                          , true); // Use Debug Messages 
    }
  catch (Exception e)
    {
     throw (new CSException("createNewBfilePointer: BFILE Creation failed: " + e.getMessage()));     
    }
  return(newBfile);
  }

protected String[] createNewBfileName(String methodName, String paramName, byte[] fileData) throws CSException
  {
  
  String[] bfileName = new String[3];
  
  if (oracleDirectoryDbName == null)
    {
    throw new CSException("createNewBfileName: variable oracleDirectoryDbName is null");
    }
  
  if (oracleDirectoryOsName == null)
    {
    throw new CSException("createNewBfileName: variable oracleDirectoryOsName is null");
    }
  
  if (bfileSequenceName == null)
    {
    throw new CSException("createNewBfileName: variable bfileSequenceName is null");
    }
  
  bfileName[BFILE_ORACLE_DIRECTORY_NAME] = oracleDirectoryDbName;
  bfileName[BFILE_OS_FILE_DIRECTORY] = oracleDirectoryOsName;
  bfileName[BFILE_OS_FILENAME] = getArbitraryGeneratedBfileName(oracleDirectoryDbName,oracleDirectoryOsName,methodName,paramName, fileData);
  
  return (bfileName);
  } 

 
public String getArbitraryGeneratedBfileName(String oracleDirectoryDbName, String oracleDirectoryOsName,String methodName, String paramName, byte[] fileData) throws CSException    
  {    
  java.sql.ResultSet tempResultSet = null;              
  String newName = null;  
                                                 
  try                        
    {                          
    if (theConnection == null)                     
      {                                              
      throw (new CSException("Not Connected - Sequence can not be accessed"));  
      }                                                                         
                                                                            
    if (bfileSequenceStatement == null)                                              
      {      
      bfileSequenceStatement = prepareBfileSequenceQry(bfileSequenceName,bfileFileExtension);   
      }    
          
    try    
      {       
      tempResultSet = bfileSequenceStatement.executeQuery();  
      tempResultSet.next();                         
      }                              
    catch (java.sql.SQLException e)          
      {                              
      theLog.warning(": Execution failed with " + e.toString());
      bfileSequenceStatement = prepareBfileSequenceQry(bfileSequenceName,bfileFileExtension);     
      tempResultSet = bfileSequenceStatement.executeQuery();  
      tempResultSet.next();                         
      }                           
                               
    theLog.debug("getArbitraryGeneratedBfileName - Starting to Retrieve value");
    newName = tempResultSet.getString(1);   
    tempResultSet.close();         
    theLog.debug("getArbitraryGeneratedBfileName - Retrieved value of " + newName );
    }                              
  catch (java.sql.SQLException e)   
    {  
    theLog.error("getArbitraryGeneratedBfileName: Retrieval failed with " + e.getMessage() );
    throw (new CSException(e.getErrorCode() + ":"+ e.toString()));   
    }                                       
                                           
  return(newName);                       
  }                                        

public java.sql.PreparedStatement prepareBfileSequenceQry(String sequenceName, String bfileFileExtension) throws CSException     
  {                                                                   
  java.sql.PreparedStatement newSeqQry;                                      
                                                                   
                                                                   
  try                                                              
    {                                                                
    theLog.debug("prepareBfileSequenceQry - Starting to parse query");
    newSeqQry = theConnection.prepareStatement("select '" + bfileFilePrefix + "'||to_char(sysdate,'YYYYMMDD_HH24MI_')||lpad(" + sequenceName + ".nextval,10,'0')||'" + bfileFileExtension + "' from dual");    
    theLog.debug("prepareBfileSequenceQry - Finished parsing query");
    }                                                                  
  catch (java.sql.SQLException e)                                    
    {                                                                   
    theLog.error("prepareBfileSequenceQry: Prepare Statement failed with " + e.toString());
    throw (new CSException("Unable to parse statement: " + e.toString()));   
    }       
            
                    
  return(newSeqQry);  
                      
  }                      
                       
public boolean releaseResources()
  {
  boolean retCode = true;
  try
    {
    if (bfileSequenceStatement != null)
      { 
      bfileSequenceStatement.close(); 
      } 
    }   
  catch (java.sql.SQLException e) 
    { 
    theLog.warning(e.toString());
    retCode = false;
    } 
  bfileSequenceStatement = null; 
  if (! super.releaseResources())
    {
    retCode = false;
    }
  return(retCode);
  }
public long serviceSequenceGenericSeq() throws DAOFactoryServiceException
  {
  try
    {
    ie.rolfe.jdbcwizard.bytetest.sequence.GenericSeq theService = getGenericSeqSequenceDAO();
    
    return (theService.getNext());
    }
  catch (com.orindasoft.pub.CSException e)
    {
    DAOFactoryServiceException e2 = new DAOFactoryServiceException(e.getMessage());
    theLog.error(e.getMessage());
    throw (e2);
    }
  }
@WebMethod
public ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageArraytest7Return servicePlsqlBytetestthepackageArraytest7
    (@WebParam(name="paramPParam1") TypeArrayLobsAttrs[] paramPParam1
    ,@WebParam(name="paramPParam2") TypeArrayLobsAttrs[] paramPParam2) throws DAOFactoryServiceException
  {
  try
    {
    theLog.debug("servicePlsqlBytetestthepackageArraytest7 Starting");
    
    if (castNullToNewObject) 
      {
      if (paramPParam1 == null) paramPParam1 = new TypeArrayLobsAttrs[0];
      if (paramPParam2 == null) paramPParam2 = new TypeArrayLobsAttrs[0];
      }
     
    ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageArraytest7Return serviceOutput = new ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageArraytest7Return();
    
    theLog.debug("servicePlsqlBytetestthepackageArraytest7: Get instance of created class");
    ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageArraytest7 theService = getBytetestthepackageArraytest7PlSqlDAO();
    
    theService.setUseByteArraysForLongsAndLOBS(true);
    
    theLog.debug("servicePlsqlBytetestthepackageArraytest7: Set parameters");
     
    if (paramPParam1 != null)
      {
      
      try
        {
        TypeArrayLobs[] theArray = TypeArrayLobs.createTypeArrayLobsArrayFromTypeArrayLobsAttrsArray(paramPParam1);
        if (theArray != null)
          {
          for (int i=0; i < theArray.length; i++)
            {
            if (theArray[i].getParamABfileByteArray() != null && theArray[i].getParamABfileByteArray().length > 0)
              {
              try
                {
                oracle.sql.BFILE tempBFILE = createNewBfilePointer("servicePlsqlBytetestthepackageArraytest7","paramPParam1", theArray[i].getParamABfileByteArray());
                theArray[i].setParamABfile(tempBFILE);
                }
              catch (Exception e)
                {
                throw new CSException("paramABfile, row " + i + ": BFILE pointer could not be created:" + e.getMessage());
                }
              }
            }
          }
        
        theService.setParamPParam1(new TblVarrayLobs(theLog, theArray));
        
        }
      catch (Exception e)
        {
        throw new CSException("paramPParam1: Unable to set LOB pointers:" + e.getMessage());
        }
       
      }
    else
      {
      theService.setParamPParam1ToNull();
      }
     
    if (paramPParam2 != null)
      {
      
      try
        {
        TypeArrayLobs[] theArray = TypeArrayLobs.createTypeArrayLobsArrayFromTypeArrayLobsAttrsArray(paramPParam2);
        if (theArray != null)
          {
          for (int i=0; i < theArray.length; i++)
            {
            if (theArray[i].getParamABfileByteArray() != null && theArray[i].getParamABfileByteArray().length > 0)
              {
              try
                {
                oracle.sql.BFILE tempBFILE = createNewBfilePointer("servicePlsqlBytetestthepackageArraytest7","paramPParam2", theArray[i].getParamABfileByteArray());
                theArray[i].setParamABfile(tempBFILE);
                }
              catch (Exception e)
                {
                throw new CSException("paramABfile, row " + i + ": BFILE pointer could not be created:" + e.getMessage());
                }
              }
            }
          }
        
        theService.setParamPParam2(new TblArrayLobs(theLog, theArray));
        
        }
      catch (Exception e)
        {
        throw new CSException("paramPParam2: Unable to set LOB pointers:" + e.getMessage());
        }
       
      }
    else
      {
      theService.setParamPParam2ToNull();
      }
    
    doPreServiceEvent(theService);
    
    theLog.debug("servicePlsqlBytetestthepackageArraytest7: Call procedure");
    theService.executeProc();
    
    theLog.debug("servicePlsqlBytetestthepackageArraytest7: Unload results");
    theService.getParamPParam1().moveLobsToByteArrays(getLoader());
    serviceOutput.paramPParam1 = theService.getParamPParam1().getCurrentValues();
    theService.getParamPParam2().moveLobsToByteArrays(getLoader());
    serviceOutput.paramPParam2 = theService.getParamPParam2().getCurrentValues();
    doPostServiceEvent(theService);
    
    theLog.debug("servicePlsqlBytetestthepackageArraytest7 Returning Data");
    return(serviceOutput);
    }
  catch (com.orindasoft.pub.CSException e)
    {
    DAOFactoryServiceException e2 = new DAOFactoryServiceException(e.getMessage());
    theLog.error("servicePlsqlBytetestthepackageArraytest7 Failed:");
    theLog.error(e.getMessage());
    if (! alwaysReleaseResources)
      {
      // release resources if finally wont
      }
    
    throw (e2);
    }
  finally
    {
    
    if (alwaysReleaseResources)
      {
      releaseResources();
      }
    
    }
  }
@WebMethod
public ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageLobDatatypesTypAttrs[] servicePlsqlBytetestthepackageCur1() throws DAOFactoryServiceException
  {
  try
    {
    theLog.debug("servicePlsqlBytetestthepackageCur1 Starting");
    
    ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageLobDatatypesTypAttrs[] serviceOutput;
    
    theLog.debug("servicePlsqlBytetestthepackageCur1: Get instance of created class");
    ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageCur1 theService = getBytetestthepackageCur1PlSqlDAO();
    
    theService.setUseByteArraysForLongsAndLOBS(true);
    
    theLog.debug("servicePlsqlBytetestthepackageCur1: Set parameters");
    
    doPreServiceEvent(theService);
    
    theLog.debug("servicePlsqlBytetestthepackageCur1: Call procedure");
    theService.executeProc();
    
    serviceOutput = BytetestthepackageLobDatatypesTyp.createBytetestthepackageLobDatatypesTypAttrsArrayFromRowSet(theService.getParamOutParam(),theLog);
    doPostServiceEvent(theService);
    
    theLog.debug("servicePlsqlBytetestthepackageCur1 Returning Data");
    return(serviceOutput);
    }
  catch (com.orindasoft.pub.CSException e)
    {
    DAOFactoryServiceException e2 = new DAOFactoryServiceException(e.getMessage());
    theLog.error("servicePlsqlBytetestthepackageCur1 Failed:");
    theLog.error(e.getMessage());
    if (! alwaysReleaseResources)
      {
      // release resources if finally wont
      }
    
    throw (e2);
    }
  finally
    {
    
    if (alwaysReleaseResources)
      {
      releaseResources();
      }
    
    }
  }
@WebMethod
public WsdlRowSet servicePlsqlBytetestthepackageCur2() throws DAOFactoryServiceException
  {
  try
    {
    theLog.debug("servicePlsqlBytetestthepackageCur2 Starting");
    
    WsdlRowSet serviceOutput;
    
    theLog.debug("servicePlsqlBytetestthepackageCur2: Get instance of created class");
    ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageCur2 theService = getBytetestthepackageCur2PlSqlDAO();
    
    theService.setUseByteArraysForLongsAndLOBS(true);
    
    theLog.debug("servicePlsqlBytetestthepackageCur2: Set parameters");
    
    doPreServiceEvent(theService);
    
    theLog.debug("servicePlsqlBytetestthepackageCur2: Call procedure");
    theService.executeProc();
    
    serviceOutput = createWSDLRowset(theService.getParamOutParam());
    doPostServiceEvent(theService);
    
    theLog.debug("servicePlsqlBytetestthepackageCur2 Returning Data");
    return(serviceOutput);
    }
  catch (com.orindasoft.pub.CSException e)
    {
    DAOFactoryServiceException e2 = new DAOFactoryServiceException(e.getMessage());
    theLog.error("servicePlsqlBytetestthepackageCur2 Failed:");
    theLog.error(e.getMessage());
    if (! alwaysReleaseResources)
      {
      // release resources if finally wont
      }
    
    throw (e2);
    }
  finally
    {
    
    if (alwaysReleaseResources)
      {
      releaseResources();
      }
    
    }
  }
@WebMethod
public WsdlRowSet servicePlsqlBytetestthepackageCur4
    (@WebParam(name="paramInParam") double paramInParam) throws DAOFactoryServiceException
  {
  try
    {
    theLog.debug("servicePlsqlBytetestthepackageCur4 Starting");
    
    WsdlRowSet serviceOutput;
    
    theLog.debug("servicePlsqlBytetestthepackageCur4: Get instance of created class");
    ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageCur4 theService = getBytetestthepackageCur4PlSqlDAO();
    
    theService.setUseByteArraysForLongsAndLOBS(true);
    
    theLog.debug("servicePlsqlBytetestthepackageCur4: Set parameters");
     
    if (minValueIsNULL && paramInParam == Double.MIN_VALUE)
      {
      theService.setParamInParamToNull();
      }
    else
      {
      theService.setParamInParam(paramInParam);
      }
       
    
    doPreServiceEvent(theService);
    
    theLog.debug("servicePlsqlBytetestthepackageCur4: Call procedure");
    theService.executeProc();
    
    theLog.debug("servicePlsqlBytetestthepackageCur4: Unload results");
    serviceOutput = createWSDLRowset(theService.getFunctionResult());
    doPostServiceEvent(theService);
    
    theLog.debug("servicePlsqlBytetestthepackageCur4 Returning Data");
    return(serviceOutput);
    }
  catch (com.orindasoft.pub.CSException e)
    {
    DAOFactoryServiceException e2 = new DAOFactoryServiceException(e.getMessage());
    theLog.error("servicePlsqlBytetestthepackageCur4 Failed:");
    theLog.error(e.getMessage());
    if (! alwaysReleaseResources)
      {
      // release resources if finally wont
      }
    
    throw (e2);
    }
  finally
    {
    
    if (alwaysReleaseResources)
      {
      releaseResources();
      }
    
    }
  }
@WebMethod
public ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageNorm1Return servicePlsqlBytetestthepackageNorm1
    (@WebParam(name="paramPInBlob") byte[] paramPInBlob
    ,@WebParam(name="paramPInClob") char[] paramPInClob) throws DAOFactoryServiceException
  {
  try
    {
    theLog.debug("servicePlsqlBytetestthepackageNorm1 Starting");
    
    ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageNorm1Return serviceOutput = new ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageNorm1Return();
    
    theLog.debug("servicePlsqlBytetestthepackageNorm1: Get instance of created class");
    ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageNorm1 theService = getBytetestthepackageNorm1PlSqlDAO();
    
    theService.setUseByteArraysForLongsAndLOBS(true);
    
    theLog.debug("servicePlsqlBytetestthepackageNorm1: Set parameters");
     
    if (paramPInBlob != null && paramPInBlob.length > 0)
      {
      theService.setParamPInBlob(paramPInBlob);
      }
     
    if (paramPInClob != null && paramPInClob.length > 0)
      {
      theService.setParamPInClob(paramPInClob);
      }
    
    doPreServiceEvent(theService);
    
    theLog.debug("servicePlsqlBytetestthepackageNorm1: Call procedure");
    theService.executeProc();
    
    theLog.debug("servicePlsqlBytetestthepackageNorm1: Unload results");
    serviceOutput.paramPOutBfile = theService.getParamPOutBfileByteArray();
    serviceOutput.paramPOutBlon = theService.getParamPOutBlonByteArray();
    serviceOutput.paramPOutClob = theService.getParamPOutClobByteArray();
    doPostServiceEvent(theService);
    
    theLog.debug("servicePlsqlBytetestthepackageNorm1 Returning Data");
    return(serviceOutput);
    }
  catch (com.orindasoft.pub.CSException e)
    {
    DAOFactoryServiceException e2 = new DAOFactoryServiceException(e.getMessage());
    theLog.error("servicePlsqlBytetestthepackageNorm1 Failed:");
    theLog.error(e.getMessage());
    if (! alwaysReleaseResources)
      {
      // release resources if finally wont
      }
    
    throw (e2);
    }
  finally
    {
    
    if (alwaysReleaseResources)
      {
      releaseResources();
      }
    
    }
  }
@WebMethod
public BytetestthepackageRecordtypeAttrs servicePlsqlBytetestthepackageRec1
    (@WebParam(name="paramInParam") BytetestthepackageRecordtypeAttrs paramInParam) throws DAOFactoryServiceException
  {
  try
    {
    theLog.debug("servicePlsqlBytetestthepackageRec1 Starting");
    
    if (castNullToNewObject) 
      {
      if (paramInParam == null) paramInParam = new BytetestthepackageRecordtypeAttrs();
      }
     
    BytetestthepackageRecordtypeAttrs serviceOutput;
    
    theLog.debug("servicePlsqlBytetestthepackageRec1: Get instance of created class");
    ie.rolfe.jdbcwizard.bytetest.plsql.BytetestthepackageRec1 theService = getBytetestthepackageRec1PlSqlDAO();
    
    theService.setUseByteArraysForLongsAndLOBS(true);
    
    theLog.debug("servicePlsqlBytetestthepackageRec1: Set parameters");
     
    if (paramInParam != null)
      {
      theService.setParamInParam(BytetestthepackageRecordtype.createBytetestthepackageRecordtypeFromBytetestthepackageRecordtypeAttrs(paramInParam));
      }
    else
      {
      theService.setParamInParamToNull();
      }
    
    doPreServiceEvent(theService);
    
    theLog.debug("servicePlsqlBytetestthepackageRec1: Call procedure");
    theService.executeProc();
    
    theLog.debug("servicePlsqlBytetestthepackageRec1: Unload results");
    theService.getParamOutParam().moveLobsToByteArrays(getLoader());
    serviceOutput = BytetestthepackageRecordtype.createBytetestthepackageRecordtypeAttrsFromBytetestthepackageRecordtype(theService.getParamOutParam());
    doPostServiceEvent(theService);
    
    theLog.debug("servicePlsqlBytetestthepackageRec1 Returning Data");
    return(serviceOutput);
    }
  catch (com.orindasoft.pub.CSException e)
    {
    DAOFactoryServiceException e2 = new DAOFactoryServiceException(e.getMessage());
    theLog.error("servicePlsqlBytetestthepackageRec1 Failed:");
    theLog.error(e.getMessage());
    if (! alwaysReleaseResources)
      {
      // release resources if finally wont
      }
    
    throw (e2);
    }
  finally
    {
    
    if (alwaysReleaseResources)
      {
      releaseResources();
      }
    
    }
  }
protected byte[] loadFileIntoByteArray(java.io.File theFile) throws CSException
  {
  byte[] newArray = null;
  try
    {
    if (theFile != null && theFile.exists() && theFile.length() > 0)
      {
      if (theFile.length() > Integer.MAX_VALUE)
        {
        throw new CSException("loadFileIntoByteArray: File " 
                             + theFile.getAbsolutePath()
                             + " is too big to be turned into a Byte array");
        }
         
      theLog.debug("loadFileIntoByteArray: Starting to load " 
                       + theFile.length()
                       + " from temp file " + theFile.getAbsolutePath() + " into byte array");

      newArray = new byte[(int)theFile.length()];
      java.io.BufferedInputStream theInputStream = new java.io.BufferedInputStream(new java.io.FileInputStream(theFile));
      theInputStream.read(newArray);
      theInputStream.close();
      theLog.debug("loadFileIntoByteArray: Finished loading byte array");
      }
    else
      {
      theLog.debug("loadFileIntoByteArray: Turning empty/null file into byte array"); 
      }
     
    }
  catch (java.io.IOException e)
    {
    throw new CSException("loadFileIntoByteArray:" + e.getMessage());
    }

  return (newArray);
  }


protected byte[] loadFileIntoByteArray(java.io.File theFile, byte[] theArray) throws CSException
  {
  if (theArray != null)
    {
    return(theArray);
    }
  return (loadFileIntoByteArray(theFile));
  }


protected java.io.File loadByteArrayIntoFile(byte[] theBytes) throws CSException
  {
  return(com.orindasoft.pub.IOUtils.loadByteArrayIntoFile(theBytes, tempFilePrefix, tempFileSuffix, tempFileDir.getAbsolutePath(), theLog));
  }
    
protected WsdlRowSet createWSDLRowset(com.orindasoft.pub.ReadOnlyRowSet theRowSet) throws CSException
  {
  WsdlRowSet newRowSet = new WsdlRowSet();
  
  if (theRowSet == null)
    {
    return(newRowSet);
    }
  
  newRowSet.columnNames = theRowSet.getColumnNamesAsStringArray();
  newRowSet.rows = new WsdlRow[theRowSet.size()];
  
  for (int i=0; i < theRowSet.size(); i++)
    {
    try
      {
      theRowSet.setCurrentRowNumber(i);
      newRowSet.rows[i] = new WsdlRow();
      Object[] currentRow  = theRowSet.getCurrentRow();
      newRowSet.rows[i].rowColumns = new WsdlElement[currentRow.length];
       
      for (int j=0; j < currentRow.length; j++)
        {
        newRowSet.rows[i].rowColumns[j] = new WsdlElement();
        newRowSet.rows[i].rowColumns[j].column = currentRow[j];
         
        if (newRowSet.rows[i].rowColumns[j].column instanceof java.io.File)
          {
          java.io.File tempFile = (java.io.File)newRowSet.rows[i].rowColumns[j].column;
          if (tempFile.exists())
            {
            newRowSet.rows[i].rowColumns[j].column = loadFileIntoByteArray(tempFile);
            tempFile.delete();
            }
          else
            {
            newRowSet.rows[i].rowColumns[j].column = new byte[0];
            }
          }
        else if (   newRowSet.rows[i].rowColumns[j].column instanceof oracle.sql.INTERVALDS 
                 || newRowSet.rows[i].rowColumns[j].column instanceof oracle.sql.INTERVALYM)
          {
          newRowSet.rows[i].rowColumns[j].column = newRowSet.rows[i].rowColumns[j].column.toString().trim();
          }
        else if (   newRowSet.rows[i].rowColumns[j].column instanceof oracle.sql.TIMESTAMP)
          {
          newRowSet.rows[i].rowColumns[j].column = oracle.sql.TIMESTAMP.toString(((oracle.sql.TIMESTAMP)newRowSet.rows[i].rowColumns[j].column).getBytes());
          }
        else if (   newRowSet.rows[i].rowColumns[j].column instanceof oracle.sql.TIMESTAMPTZ)
          {
          try 
            {
            newRowSet.rows[i].rowColumns[j].column = oracle.sql.TIMESTAMPTZ.toString(theConnection,((oracle.sql.TIMESTAMPTZ)newRowSet.rows[i].rowColumns[j].column).getBytes());
            }
          catch (java.sql.SQLException e)
            {
            theLog.error("Row " + i + " Column " + newRowSet.columnNames[j] +": SQLException thrown:"); 
            theLog.error(e);   
            throw new CSException(e.getMessage());
            }
          }
        else if (   newRowSet.rows[i].rowColumns[j].column instanceof oracle.sql.TIMESTAMPLTZ)
          {
          try 
            {
            newRowSet.rows[i].rowColumns[j].column = oracle.sql.TIMESTAMPLTZ.toString(theConnection,((oracle.sql.TIMESTAMPLTZ)newRowSet.rows[i].rowColumns[j].column).getBytes());
            }
          catch (java.sql.SQLException e)
            {
            theLog.error("Row " + i + " Column " + newRowSet.columnNames[j] +": SQLException thrown:"); 
            theLog.error(e);   
            throw new CSException(e.getMessage());
            }
          }
        else if (newRowSet.rows[i].rowColumns[j].column instanceof CSException)
          {
          theLog.error("Row " + i + " Column " + newRowSet.columnNames[j] +": CSException found instead of LOB.:"); 
          theLog.error((CSException)newRowSet.rows[i].rowColumns[j].column);
          throw((CSException)newRowSet.rows[i].rowColumns[j].column);
          }
         
        }
      }
    catch (com.orindasoft.pub.CSNoDataInRowSetException e)
      {
      newRowSet.rows[i] = null;
      }
    }
  return(newRowSet);
  }
 
private void executeImmediate(String ddl, int allowableErrorCode) throws CSException
  {                                                                   
  java.sql.CallableStatement theStatement = null;                                      
                                                                   
  if (theConnection == null)
    {                                  
    throw (new CSException("Not Connected - Statement can not be issued"));  
    }                      
                                                                   
  try                                                              
    {                                                                
    theLog.info(ddl);
    theLog.debug("executeImmediate - Starting to parse statement");
    theStatement = theConnection.prepareCall(ddl);    
    theLog.debug("executeImmediate - Finished parsing statement");
    }                                                                  
  catch (java.sql.SQLException e)                                    
    {                                                                   
    theLog.error("executeImmediate: Prepare Statement failed with " + e.toString());
    CSDBException e2 = new CSDBException(e.getErrorCode(),e.getMessage(),"executeImmediate","DAOFactory");
    throw (e2);   
    }       
                                                                
  try                                                              
    {                                                                
    theStatement.execute();
    theStatement.close();
    }
  catch (java.sql.SQLException e)
    {
    if (e.getErrorCode() != allowableErrorCode)
      {                                  
      theLog.error("DAOFactory - Execute Immediate Failed:");
      theLog.error(e);
      CSDBException e2 = new CSDBException(e.getErrorCode(),e.getMessage(),"executeImmediate","DAOFactory");
      throw(e2);
      }
    }
  }                      
 
public void createExtraTypeObjects() throws CSException
  {
  confirmConnection("createExtraTypeObjects");
   
   
  }
 
public void dropExtraTypeObjects() throws CSException
  {
  confirmConnection("dropExtraTypeObjects");
   
  }
 
public void dropAllExtraTypeObjects() throws CSException
  {
   
  final String DROP_ALL_TYPES_BLOCK = 
      "DECLARE\n" 
    + "--\n"  
    + "CURSOR typecur IS\n" 
    + "SELECT 'DROP TYPE '||type_name cmd\n" 
    + "FROM user_types\n"
    + "WHERE type_name LIKE '" + tempFilePrefix.toUpperCase()  + "%'\n" 
    + "ORDER BY DECODE (typecode,'COLLECTION',1,2), type_name;\n"
    + "--\n" 
    + "BEGIN\n"  
    + "--\n"
    + "FOR typerec IN typecur LOOP\n" 
    + "--\n" 
    + "  EXECUTE IMMEDIATE typerec.cmd;\n" 
    + "--\n" 
    + "END LOOP;\n" 
    + "--\n" 
    + "END;\n"; 
   
  confirmConnection("dropAllExtraTypeObjects");
  executeImmediate(DROP_ALL_TYPES_BLOCK,0); 
   
  }
} // Generated by JDBCWizard 6.0.3145                                                  
