package ie.rolfe.jdbcwizard.generic_testd.table.manager;


import java.sql.*; 
import com.orindasoft.pub.LogInterface; 
import com.orindasoft.pub.LongObjectLoader; 
import com.orindasoft.pub.StatsInterface; 
import com.orindasoft.pub.OracleResourceUser; 
import com.orindasoft.pub.CSException; 
import com.orindasoft.pub.ReadOnlyRowSet; 
/** 
* Abstract table class used by all classes generated by JDBCWizard
* Generated by JDBCWizard 6.0.3145 build 3145 at 2025/11/14 10:13:51.669 EST
*/ 
public abstract class AbstractTableMgr implements OracleResourceUser, StatsInterface 
{ 
  long parseCount = 0;                          
                                                
  long parseTimeMilliseconds = 0;                          
                                                
  long executionCount = 0;                               
                                                       
  long executionTimeMilliseconds = 0;                               
                                                       
  long retrieveTimeMilliseconds = 0;                               
                                                       
  long releaseCount = 0;                              
  
  long errorCount = 0;                              
  
  long statsEventTimer = 0;                              
  
  
  protected int bufferSize = 4096;
  
  protected LongObjectLoader objectLoader = new LongObjectLoader();
  
  GenericTableBfileCreator bfileGenerator = null;
  
  public Connection theConnection = null; 
  
  public com.orindasoft.pub.LogInterface theLog = null; 
  
  public AbstractTableMgr (Connection theConnection, LogInterface theLog) 
    { 
    this.theConnection = theConnection; 
    this.theLog = theLog; 
    } 
  
  public void setBufferSize(int bufferSize)
    {
    this.bufferSize = bufferSize;
    theLog.debug("bufferSize set to " + bufferSize);
    }
   
  public oracle.sql.BFILE createBFILEPointer(String bfileDirectoryName, String bfileFileName) throws CSException
    { 
    if (bfileGenerator == null)
      { 
      bfileGenerator = new GenericTableBfileCreator(theConnection, theLog);
      bfileGenerator.setKeepLobs(true);
      }
     
    bfileGenerator.setParamBfileFileDir(bfileDirectoryName);
    bfileGenerator.setParamBfileFileName(bfileFileName);
    ReadOnlyRowSet bfileRowset = bfileGenerator.executeQuery();
    Object[] theRow = bfileRowset.getCurrentRow();
      
    if (theRow.length != 1)
      {
      throw new CSException("Unexpected failure in createBFILEPointer: BFILE Array is wrong length");
      }
      
    if (theRow[0] instanceof CSException)
      {
      throw((CSException)theRow[0]);
      }
     
    return((oracle.sql.BFILE)theRow[0]);
    }
  
  public void startStatsTimer()      
    {                                    
    statsEventTimer = System.currentTimeMillis();
    }                         
   
  public void incRetrieveTime()   
    {                               
    retrieveTimeMilliseconds = retrieveTimeMilliseconds + (System.currentTimeMillis() - statsEventTimer);
    statsEventTimer=0;
    }                                
   
  public void incErrorCount()     
    {                                  
    if (errorCount < Long.MAX_VALUE)   
      {                                   
      errorCount++;                  
      }                                    
    else  
      {      
      theLog.syserror("error counter is greater than " + releaseCount);   
      }                          
    } 
  public void incReleaseCount()     
    {                                  
    if (releaseCount < Long.MAX_VALUE)   
      {                                   
      releaseCount++;                  
      }                                    
    else  
      {      
      theLog.syserror("release counter is greater than " + releaseCount);   
      }                          
    } 
   
  } // Generated by JDBCWizard 6.0.3145  
